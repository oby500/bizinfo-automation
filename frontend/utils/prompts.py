#!/usr/bin/env python
# -*- coding: utf-8 -*-
"""
AI 신청서 작성 시스템 - 프롬프트 템플릿

Claude Sonnet 4.5 + GPT-4o 프롬프트 템플릿 정의
"""

# ================================================
# Claude Sonnet 4.5 - 공고 분석 프롬프트
# ================================================

ANALYZE_ANNOUNCEMENT_PROMPT = """
당신은 20년 경력의 정부지원사업 전문 컨설턴트입니다.
과거 수백 개의 정부지원사업 선정 경험이 있으며, 평가위원의 관점을 정확히 이해하고 있습니다.

<공고문 전체 텍스트>
{full_text}
</공고문 전체 텍스트>

<기존 AI 요약 (참고용)>
간단 요약:
{simple_summary}

상세 요약:
{detailed_summary}
</기존 AI 요약>

<페이지 구조 메타데이터>
{parsed_info_content_map}
</페이지 구조 메타데이터>

다음을 **매우 상세히** 분석하여 JSON으로 출력하세요:

{{
  "자격요건": [
    {{
      "항목": "사업자 등록 여부",
      "내용": "중소기업 또는 스타트업으로 사업자 등록이 되어 있어야 함",
      "충족여부_판단기준": "사업자등록증 사본 제출 필수",
      "필수여부": "필수",
      "중요도": "높음"
    }}
  ],

  "평가기준": [
    {{
      "대항목": "기술력",
      "배점": 40,
      "비중": "40%",
      "세부항목": [
        {{
          "항목": "기술 수준 및 차별성",
          "배점": 20,
          "평가포인트": [
            "핵심 기술의 독창성",
            "경쟁사 대비 기술적 우위",
            "특허 및 지식재산권 보유 현황",
            "기술 구현 완성도"
          ],
          "작성전략": "표를 활용하여 경쟁사 대비 수치로 비교, 특허 목록 제시, 기술 검증 자료 첨부",
          "심사위원_주목점": "정량적 비교 데이터, 객관적 검증 자료"
        }},
        {{
          "항목": "R&D 역량",
          "배점": 10,
          "평가포인트": [
            "연구개발 투자 비율",
            "연구인력 구성",
            "과거 R&D 성과"
          ],
          "작성전략": "최근 3년 R&D 투자액 표로 제시, 연구인력 경력 상세 기술",
          "심사위원_주목점": "지속적인 R&D 투자 여부, 전문인력 보유"
        }},
        {{
          "항목": "기술 실현 가능성",
          "배점": 10,
          "평가포인트": [
            "구체적인 개발 계획",
            "위험 요소 및 대응방안",
            "일정 및 마일스톤"
          ],
          "작성전략": "간트 차트 활용, 단계별 성과물 명시, 리스크 관리 계획 구체화",
          "심사위원_주목점": "현실적인 일정 계획, 위험 대비 능력"
        }}
      ],
      "작성시_중요사항": "표와 그래프 활용 권장, 객관적 수치 중심 서술, 추상적 표현 지양"
    }},

    {{
      "대항목": "사업성",
      "배점": 30,
      "비중": "30%",
      "세부항목": [
        {{
          "항목": "시장 분석",
          "배점": 10,
          "평가포인트": [
            "목표 시장 규모 및 성장성",
            "시장 트렌드 분석",
            "고객 니즈 파악"
          ],
          "작성전략": "공신력 있는 시장 조사 자료 인용, 시장 규모 수치화, 성장률 그래프 제시",
          "심사위원_주목점": "출처가 명확한 시장 데이터, 현실적인 시장 분석"
        }},
        {{
          "항목": "수익 모델",
          "배점": 10,
          "평가포인트": [
            "매출 구조의 명확성",
            "수익성 전망",
            "재무 계획"
          ],
          "작성전략": "연도별 매출 계획 표로 제시, BEP 분석, 핵심 가정 명시",
          "심사위원_주목점": "실현 가능한 매출 계획, 근거 있는 재무 전망"
        }},
        {{
          "항목": "경쟁력",
          "배점": 10,
          "평가포인트": [
            "경쟁사 분석",
            "차별화 전략",
            "진입 장벽"
          ],
          "작성전략": "경쟁사 비교 표 작성, SWOT 분석, 차별화 요소 부각",
          "심사위원_주목점": "명확한 경쟁 우위, 지속 가능한 차별화"
        }}
      ],
      "작성시_중요사항": "시장 데이터는 최근 자료 사용, 출처 명시, 과도한 낙관 지양"
    }},

    {{
      "대항목": "실행력",
      "배점": 30,
      "비중": "30%",
      "세부항목": [
        {{
          "항목": "추진 체계",
          "배점": 15,
          "평가포인트": [
            "조직 구성의 적정성",
            "인력 전문성",
            "역할 분담"
          ],
          "작성전략": "조직도 제시, 핵심 인력 경력 상세 기술, 외부 자문단 구성",
          "심사위원_주목점": "전문 인력 보유 여부, 조직의 안정성"
        }},
        {{
          "항목": "추진 일정",
          "배점": 10,
          "평가포인트": [
            "단계별 목표 명확성",
            "일정의 현실성",
            "성과 지표"
          ],
          "작성전략": "월별 상세 일정 표 작성, KPI 설정, 마일스톤 명시",
          "심사위원_주목점": "구체적인 실행 계획, 측정 가능한 성과 지표"
        }},
        {{
          "항목": "예산 계획",
          "배점": 5,
          "평가포인트": [
            "예산 배분의 합리성",
            "자부담 능력",
            "비용 효율성"
          ],
          "작성전략": "항목별 세부 예산 표 작성, 자부담 재원 명시, 집행 계획 구체화",
          "심사위원_주목점": "합리적인 예산 배분, 자부담 확보 능력"
        }}
      ],
      "작성시_중요사항": "현실적인 계획 수립, 과도한 목표 설정 지양"
    }}
  ],

  "심사위원_프로파일": {{
    "구성": {{
      "기술전문가": 60,
      "경영전문가": 30,
      "회계사": 10
    }},
    "선호스타일": "데이터 중심, 객관적 근거, 정량적 지표",
    "중요포인트": [
      "실현 가능성",
      "객관적 수치",
      "구체적 계획",
      "검증 가능한 성과"
    ],
    "기피표현": [
      "노력하겠습니다",
      "최선을 다하겠습니다",
      "세계 최고",
      "혁신적인",
      "획기적인"
    ],
    "선호표현": [
      "구체적인 수치",
      "객관적 비교",
      "검증된 결과",
      "정량적 목표"
    ]
  }},

  "핵심키워드": {{
    "필수": [
      "차별성",
      "시장성",
      "실현가능성",
      "기술력",
      "수익성"
    ],
    "권장빈도": {{
      "차별성": "5-7회",
      "기술력": "7-10회",
      "시장성": "4-6회",
      "실현가능성": "3-5회"
    }},
    "섹션배치": {{
      "도입부": ["차별성", "혁신성"],
      "기술섹션": ["기술력", "독창성", "특허"],
      "사업섹션": ["시장성", "수익성", "성장성"],
      "실행섹션": ["실현가능성", "추진력", "안정성"]
    }}
  }},

  "경쟁강도": {{
    "예상경쟁률": "10:1",
    "난이도": "높음",
    "차별화필요도": "매우높음",
    "선정률": "10%",
    "최소_합격점": "75점 이상"
  }},

  "작성전략": {{
    "전체톤": "전문적이고 객관적, 과장 없는 사실 중심",
    "표사용": "5-7개 권장",
    "그래프사용": "2-3개 권장",
    "페이지수": "15-20페이지 (별첨 제외)",
    "섹션별강조": {{
      "기술력": "표와 수치로 증명, 특허 및 기술 검증 자료 첨부",
      "사업성": "시장 데이터 활용, 재무 계획 구체화",
      "실행력": "구체적 일정과 예산, 조직 역량 강조"
    }},
    "피해야할_표현": [
      "추상적인 미래 계획",
      "검증 불가능한 주장",
      "과도한 수식어",
      "애매한 목표"
    ],
    "강조해야할_요소": [
      "객관적 데이터",
      "구체적 수치",
      "실적 증명",
      "검증 가능한 계획"
    ]
  }},

  "제출서류_체크리스트": [
    {{
      "서류명": "사업계획서",
      "필수여부": "필수",
      "주의사항": "모든 평가 기준에 대응하는 내용 포함"
    }},
    {{
      "서류명": "사업자등록증 사본",
      "필수여부": "필수",
      "주의사항": "유효한 등록증, 만료일 확인"
    }},
    {{
      "서류명": "재무제표",
      "필수여부": "필수",
      "주의사항": "최근 3개년 재무제표, 회계사 확인 필요"
    }},
    {{
      "서류명": "특허증 사본",
      "필수여부": "해당시",
      "주의사항": "기술력 평가에 활용"
    }}
  ],

  "추가_분석": {{
    "공고_특징": "기술 중심 평가, 정량 지표 비중 높음",
    "성공_포인트": "객관적 데이터, 구체적 계획, 검증 가능한 성과",
    "실패_위험요소": "추상적 계획, 과도한 목표, 근거 부족",
    "추천_준비사항": [
      "시장 조사 자료 수집",
      "경쟁사 분석 데이터 준비",
      "재무 계획 정교화",
      "특허 및 기술 검증 자료 확보"
    ]
  }}
}}

**중요**:
1. 모든 평가 기준을 빠짐없이 분석하세요
2. 배점이 높은 항목일수록 더 상세히 분석하세요
3. 심사위원의 관점에서 평가하세요
4. 구체적이고 실행 가능한 작성 전략을 제시하세요
5. JSON 형식을 정확히 지켜주세요
"""


# ================================================
# Claude Sonnet 4.5 - 회사 분석 프롬프트
# ================================================

ANALYZE_COMPANY_PROMPT = """
당신은 20년 경력의 정부지원사업 전문 컨설턴트입니다.
회사의 강점과 약점을 정확히 파악하고, 공고 평가기준에 최적화된 전략을 수립하는 전문가입니다.

<공고분석>
{announcement_analysis}
</공고분석>

<회사정보>
{company_info}
</회사정보>

회사와 공고를 매칭 분석하여 **매우 상세한** JSON으로 출력하세요:

{{
  "강점분석": [
    {{
      "강점": "특허 2건 보유 (AI 기반 데이터 분석, 자동화 시스템)",
      "대응평가기준": "기술력 > 기술 수준 및 차별성 (20점)",
      "점수기여도": "15-18점 예상 (만점 대비 75-90%)",
      "활용방법": "표로 특허 상세 내역 제시 (특허번호, 등록일, 핵심기술, 차별성)",
      "추가전략": [
        "특허가 실제 제품에 적용된 구체적 사례 제시",
        "특허 기술의 시장 경쟁력 수치화",
        "향후 추가 특허 출원 계획 명시"
      ],
      "예상기여": "기술력 섹션에서 15-18점 확보 가능",
      "증빙자료": [
        "특허증 사본",
        "특허 기술 적용 사례",
        "기술 검증 자료"
      ],
      "작성예시": "당사는 'AI 기반 데이터 분석 시스템(특허 제10-XXXX호)'과 '자동화 프로세스 최적화 시스템(특허 제10-YYYY호)' 2건의 특허를 보유하고 있으며, 이는 경쟁사 대비 처리 속도 5배, 정확도 95% 이상의 기술적 우위를 제공합니다."
    }},
    {{
      "강점": "최근 3년간 연평균 성장률 45%",
      "대응평가기준": "사업성 > 수익 모델 (10점)",
      "점수기여도": "8-10점 예상",
      "활용방법": "연도별 매출 추이 그래프 제시, 성장 요인 분석",
      "추가전략": [
        "성장률의 지속 가능성 근거 제시",
        "향후 3년 성장 전망 구체화",
        "성장을 뒷받침하는 시장 데이터 인용"
      ],
      "예상기여": "사업성 섹션에서 8-10점 확보 가능",
      "증빙자료": [
        "최근 3개년 재무제표",
        "매출 증가 요인 분석 자료",
        "향후 성장 계획"
      ],
      "작성예시": "당사는 2022년 5억원, 2023년 7.25억원, 2024년 10.5억원으로 연평균 45% 성장하였으며, 이는 시장 평균(15%) 대비 3배 높은 수치입니다."
    }}
  ],

  "약점분석": [
    {{
      "약점": "팀 규모 작음 (15명, 개발자 8명)",
      "불리한기준": "실행력 > 추진 체계 (15점)",
      "점수손실": "3-5점 손실 예상",
      "보완전략": [
        "핵심 인력의 높은 전문성 강조 (평균 경력 10년)",
        "외부 협력사 네트워크 구축 현황 제시",
        "전문 자문단 구성 (기술, 경영, 재무)",
        "필요시 인력 충원 계획 명시"
      ],
      "대안제시": [
        "소규모 조직의 빠른 의사결정 장점 부각",
        "핵심 인력 1인당 생산성 수치화",
        "프로젝트 수행 실적으로 역량 증명"
      ],
      "예상손실": "3-5점 (보완 전략으로 1-2점으로 최소화 가능)",
      "작성예시": "당사는 15명의 핵심 인력으로 구성되어 있으나, 평균 경력 10년 이상의 전문가들로 구성되어 있으며, 1인당 연평균 매출 7천만원으로 업계 평균(4천만원) 대비 1.75배 높은 생산성을 보이고 있습니다."
    }},
    {{
      "약점": "해외 시장 진출 경험 부족",
      "불리한기준": "사업성 > 경쟁력 (10점)",
      "점수손실": "2-3점 손실 예상",
      "보완전략": [
        "국내 시장 우선 공략 후 해외 진출 단계적 계획",
        "해외 진출을 위한 파트너십 체결 현황",
        "글로벌 시장 조사 완료 및 전략 수립"
      ],
      "대안제시": [
        "국내 시장 점유율 확대로 기반 마련",
        "수출 바우처 등 해외 진출 지원사업 연계",
        "현지 파트너와의 협력 계획"
      ],
      "예상손실": "2-3점 (보완 전략으로 1점 이하로 최소화 가능)",
      "작성예시": "현재 국내 시장에 집중하고 있으나, 2025년 하반기 동남아 시장 진출을 위해 현지 파트너 3곳과 MOU를 체결하였으며, KOTRA 해외 진출 프로그램에 참여 중입니다."
    }}
  ],

  "차별화포인트": [
    {{
      "포인트": "AI 정밀도 업계 1위 (±0.1%, 경쟁사 평균 ±0.5%)",
      "경쟁사대비": "정확도 5배 우수",
      "수치화": "오차율 0.1% vs 경쟁사 평균 0.5%",
      "강조방법": [
        "도입부에 임팩트 있게 제시",
        "경쟁사 비교 표 작성",
        "제3자 검증 자료 첨부"
      ],
      "스토리": "10년간 R&D에 매출의 25% 지속 투자로 달성한 기술력",
      "활용섹션": [
        "기술력 (도입부)",
        "경쟁력 (차별화 요소)",
        "사업성 (경쟁 우위)"
      ],
      "작성예시": "당사의 AI 정밀도는 ±0.1%로 업계 1위 수준이며, 경쟁사 평균(±0.5%) 대비 5배 우수합니다. 이는 10년간 매출의 25%를 R&D에 투자한 결과이며, 한국산업기술시험원의 제3자 검증을 완료하였습니다."
    }},
    {{
      "포인트": "고객 재구매율 87% (업계 평균 45%)",
      "경쟁사대비": "재구매율 2배",
      "수치화": "87% vs 업계 평균 45%",
      "강조방법": [
        "고객 만족도 그래프",
        "주요 고객사 리스트",
        "고객 추천 사례"
      ],
      "스토리": "제품 품질과 A/S로 높은 고객 충성도 확보",
      "활용섹션": [
        "사업성 (시장 경쟁력)",
        "실행력 (사업 안정성)"
      ],
      "작성예시": "당사 제품의 고객 재구매율은 87%로 업계 평균(45%) 대비 2배 높으며, 이는 제품 품질과 24시간 A/S 시스템으로 확보한 높은 고객 충성도를 보여줍니다."
    }}
  ],

  "리스크체크": {{
    "자격요건": {{
      "충족": true,
      "주의사항": [
        "사업자등록증 유효기간 확인",
        "직원 수 최소 요건 확인 (현재 15명, 요구사항 10명 이상)"
      ],
      "보완필요": []
    }},
    "제출서류": {{
      "준비완료": [
        "사업자등록증 사본",
        "재무제표 (최근 3개년)",
        "특허증 사본"
      ],
      "누락위험": [
        "기술 검증 자료 (제3자 인증)"
      ],
      "추가준비": [
        "고객사 추천서",
        "외부 협력사 MOU"
      ]
    }},
    "예산한도": {{
      "총사업비": 100000000,
      "정부지원금": 70000000,
      "자부담": 30000000,
      "자부담_확보": true,
      "자부담_재원": "자체 자금 50%, 은행 대출 50%",
      "초과위험": false
    }},
    "일정": {{
      "준비기간": "충분",
      "제출마감": "2025-06-30",
      "현재일": "2025-01-10",
      "남은기간": "171일",
      "주의사항": "서류 준비에 최소 30일 필요"
    }}
  }},

  "최종전략": {{
    "추천스타일": "데이터 중심형 (표와 그래프 중심)",
    "이유": [
      "공고 평가기준이 정량 평가 비중 높음 (60%)",
      "귀사의 수치적 강점 (특허, 성장률, 정밀도) 활용 가능",
      "심사위원 구성 (기술전문가 60%)에 최적화"
    ],
    "섹션우선순위": [
      {{
        "섹션": "기술력",
        "배점": 40,
        "전략": "특허와 정밀도 수치로 차별성 강조",
        "목표점수": "35-38점"
      }},
      {{
        "섹션": "사업성",
        "배점": 30,
        "전략": "성장률과 재구매율로 시장성 증명",
        "목표점수": "25-28점"
      }},
      {{
        "섹션": "실행력",
        "배점": 30,
        "전략": "핵심 인력의 전문성과 협력사 네트워크 강조",
        "목표점수": "22-25점"
      }}
    ],
    "강조내용": [
      "특허 2건 (표로 상세)",
      "AI 정밀도 ±0.1% (경쟁사 비교)",
      "성장률 45% (3개년 그래프)",
      "재구매율 87% (고객 충성도)"
    ],
    "최소화내용": [
      "팀 규모 (전문성으로 대체)",
      "해외 진출 경험 (단계적 계획으로 보완)"
    ],
    "목표점수": "82-91점 (100점 만점)",
    "합격가능성": "높음 (최소 합격점 75점 이상 확보 가능)"
  }},

  "작성시_핵심전략": {{
    "도입부": "차별화 포인트를 임팩트 있게 제시 (AI 정밀도, 성장률)",
    "기술섹션": "특허와 기술 검증 자료로 객관성 확보",
    "사업섹션": "시장 데이터와 재무 계획으로 사업성 증명",
    "실행섹션": "전문 인력과 협력사로 실행력 보완",
    "결론": "구체적 목표와 기대 효과로 마무리"
  }}
}}

**중요**:
1. 강점은 최대한 부각하고 구체적인 활용 방법을 제시하세요
2. 약점은 솔직히 인정하되 반드시 보완 전략을 제시하세요
3. 모든 분석에 예상 점수와 기여도를 명시하세요
4. 차별화 포인트는 수치화하여 경쟁사와 비교하세요
5. 최종 목표 점수와 합격 가능성을 명확히 제시하세요
"""


# ================================================
# GPT-4o - 신청서 생성 프롬프트
# ================================================

GENERATE_APPLICATION_PROMPT = """
당신은 정부지원사업 신청서 작성 전문가입니다.
과거 100개 이상의 선정된 신청서를 작성한 경험이 있으며, 심사위원의 평가 관점을 정확히 이해하고 있습니다.

<공고분석>
{announcement_analysis}
</공고분석>

<회사분석>
{company_analysis}
</회사분석>

<작성원칙>
1. **평가 기준 100% 대응**: 모든 평가 항목에 대한 답변 포함
2. **구체적 근거 제시**: 모든 주장에 수치, 데이터, 사례 등 객관적 근거
3. **정확한 수치**: 추정이 아닌 실제 데이터 사용
4. **표 활용**: 비교, 계획, 현황 등을 표로 시각화 (5-7개)
5. **과장 금지**: 검증 가능한 사실만 기술

<금지 표현>
❌ "노력하겠습니다" - 구체적 계획으로 대체
❌ "최선을 다하겠습니다" - 정량적 목표로 대체
❌ "최고", "최선" - 객관적 비교 데이터로 대체
❌ "혁신적인", "획기적인" - 구체적 차별성으로 대체
❌ 검증 불가능한 주장 - 증빙 가능한 내용만

<권장 표현>
✅ "2025년 6월까지 프로토타입 개발 완료" (구체적 일정)
✅ "월 매출 5천만원 목표 (현재 3천만원 대비 67% 증가)" (정량적 목표)
✅ "경쟁사 A 대비 처리 속도 5배 향상 (당사 2초, A사 10초)" (객관적 비교)
✅ "특허 제10-XXXX호로 기술적 독점권 확보" (구체적 차별성)

<스타일: {style}>
{style_guide}
</스타일>

<출력형식>
마크다운 형식으로 작성하세요.
표는 마크다운 표 형식을 사용하세요.

# [사업명]

## 1. 사업 개요
(회사 소개, 사업 목적, 기대 효과 등)

## 2. 기술력 (40점)
### 2.1 기술 수준 및 차별성 (20점)
(특허, 핵심 기술, 경쟁사 대비 우위 등)

[표 1: 보유 특허 현황]
| 특허번호 | 특허명 | 등록일 | 핵심기술 | 차별성 |
|---------|-------|--------|---------|--------|
| ... | ... | ... | ... | ... |

### 2.2 R&D 역량 (10점)
(연구개발 투자, 연구인력, 과거 성과 등)

### 2.3 기술 실현 가능성 (10점)
(개발 계획, 위험 요소, 대응 방안 등)

## 3. 사업성 (30점)
### 3.1 시장 분석 (10점)
(시장 규모, 성장성, 트렌드 등)

### 3.2 수익 모델 (10점)
(매출 구조, 재무 계획, BEP 등)

[표 3: 연도별 매출 계획]
| 구분 | 2024 | 2025 | 2026 | 2027 |
|-----|------|------|------|------|
| ... | ... | ... | ... | ... |

### 3.3 경쟁력 (10점)
(경쟁사 분석, 차별화 전략, 진입 장벽 등)

## 4. 실행력 (30점)
### 4.1 추진 체계 (15점)
(조직 구성, 인력 전문성, 역할 분담 등)

### 4.2 추진 일정 (10점)
(단계별 목표, 일정, 성과 지표 등)

[표 5: 월별 추진 일정]
| 월 | 주요 활동 | 성과물 | 담당 | KPI |
|----|---------|-------|------|-----|
| ... | ... | ... | ... | ... |

### 4.3 예산 계획 (5점)
(항목별 예산, 자부담 재원, 집행 계획 등)

## 5. 기대 효과
(정량적 효과, 정성적 효과, 파급 효과 등)

---

**작성 지침**:
1. 각 섹션은 해당 평가 기준의 배점을 고려하여 분량 조절
2. 표는 5-7개 작성 (핵심 내용 시각화)
3. 모든 수치는 출처 명시 또는 계산 근거 제시
4. 문장은 간결하고 명확하게 (한 문장 2줄 이내)
5. 전체 분량: 15-20페이지 (A4 기준, 표 포함)

이제 신청서를 작성하세요.
"""


# 스타일별 가이드
STYLE_GUIDES = {
    "data": """
**데이터 중심형 작성 가이드**

특징:
- 표 5-7개 사용 (비교, 계획, 현황 등)
- 모든 주장에 수치와 데이터 제시
- Before/After 비교 강조
- 정량적 목표 및 성과 지표 명시

예시:
"당사의 AI 정밀도는 ±0.1%로 경쟁사 평균(±0.5%) 대비 5배 우수합니다. 이는 10년간 R&D에 매출의 25%(연평균 1.2억원)를 투자한 결과입니다."

[표: 경쟁사 대비 기술 비교]
| 항목 | 당사 | A사 | B사 | 업계평균 |
|-----|------|-----|-----|----------|
| 정밀도 | ±0.1% | ±0.3% | ±0.7% | ±0.5% |
| 처리속도 | 2초 | 5초 | 10초 | 7초 |
| 정확도 | 98% | 92% | 85% | 90% |

작성 팁:
1. 도입부부터 임팩트 있는 수치 제시
2. 주요 주장마다 표로 뒷받침
3. 경쟁사 비교는 반드시 수치화
4. 목표는 구체적인 숫자로 제시
""",

    "story": """
**스토리텔링형 작성 가이드**

특징:
- 회사의 성장 과정과 비전 강조
- 팀의 열정과 철학 표현
- 감성적 어필과 공감대 형성
- 표 2-3개 (핵심 데이터만)

예시:
"2015년 소규모 스타트업으로 시작한 당사는 '기술로 세상을 편리하게'라는 비전 아래 10년간 한 우물만 파왔습니다. 수많은 시행착오 끝에 개발한 AI 기술은 이제 업계 1위의 정밀도를 자랑하며, 87%의 고객이 재구매를 선택하는 신뢰받는 브랜드가 되었습니다."

작성 팁:
1. 회사의 설립 배경과 여정
2. 핵심 기술 개발 과정의 스토리
3. 고객 성공 사례와 피드백
4. 팀의 비전과 미래 계획
5. 사회적 가치와 기여

주의: 스토리 중심이지만 핵심 수치는 반드시 포함
""",

    "balanced": """
**균형형 작성 가이드**

특징:
- 데이터와 스토리의 조화
- 표 3-4개 (적절한 시각화)
- 객관적 근거 + 비전 제시
- 가장 무난하고 범용적

예시:
"당사는 2015년 설립 이후 'AI 기술 혁신'이라는 목표 아래 꾸준히 성장해왔습니다. 10년간 R&D에 매출의 25%를 투자하여 개발한 AI 기술은 ±0.1%의 업계 최고 정밀도를 달성했으며, 이를 바탕으로 최근 3년간 연평균 45% 성장을 이루었습니다."

[표: 3개년 성장 현황]
| 연도 | 매출 | 성장률 | R&D 투자 |
|-----|------|--------|----------|
| 2022 | 5억 | - | 1.2억 (24%) |
| 2023 | 7.25억 | 45% | 1.8억 (25%) |
| 2024 | 10.5억 | 45% | 2.6억 (25%) |

작성 팁:
1. 각 섹션마다 스토리 → 데이터 순으로 전개
2. 핵심 주장은 표로 뒷받침
3. 과도한 수식어 지양, 사실 중심
4. 정량적 목표 + 정성적 비전 병행
""",

    "aggressive": """
**공격형 작성 가이드**

특징:
- 압도적 차별성 강조
- "왜 우리만 가능한가" 포커스
- 혁신성과 파괴적 기술 부각
- 강한 톤의 주장

예시:
"당사의 AI 기술은 기존 패러다임을 완전히 바꿉니다. 경쟁사가 10초 걸리는 작업을 2초에 완료하며, 정밀도는 5배 우수합니다. 이는 단순한 개선이 아닌, 시장 판도를 바꿀 혁신입니다. 2건의 핵심 특허로 독점권을 확보했으며, 기술 장벽은 경쟁사가 3-5년 내 따라올 수 없는 수준입니다."

작성 팁:
1. 도입부부터 강한 임팩트
2. 경쟁사 대비 압도적 우위 부각
3. 독점적 기술, 특허 강조
4. 시장 지배력 및 선점 효과
5. 모방 불가능한 차별성

주의: 과장 금지, 모든 주장에 근거 필수
""",

    "conservative": """
**보수형 작성 가이드**

특징:
- 안정성과 신뢰성 중심
- 리스크 최소화 강조
- 검증된 역량과 실적
- 신중하고 보수적인 톤

예시:
"당사는 10년간 안정적인 성장을 지속해왔습니다. 특허 2건, 벤처기업 인증, 기술혁신형 중소기업 인증 등 객관적인 역량 검증을 완료했으며, 87%의 높은 고객 재구매율로 시장에서의 신뢰를 입증했습니다. 본 사업은 검증된 기술과 안정적인 재무 구조를 바탕으로 단계적이고 현실적인 목표를 설정했습니다."

작성 팁:
1. 검증된 실적과 인증 부각
2. 리스크 대응 방안 상세 기술
3. 보수적이고 현실적인 목표
4. 안정적인 재무 구조 강조
5. 단계적이고 신중한 계획

주의: 보수적이지만 성장 가능성은 제시
"""
}


# ================================================
# Claude Sonnet 4.5 - AI 추천 프롬프트
# ================================================

RECOMMEND_STYLE_PROMPT = """
당신은 정부지원사업 전문 컨설턴트로서, 생성된 여러 스타일의 신청서 중 가장 적합한 것을 추천하는 역할을 합니다.

<공고분석>
{announcement_analysis}
</공고분석>

<회사분석>
{company_analysis}
</회사분석>

<생성된스타일들>
{generated_applications}
</생성된스타일들>

**중요한 제약사항**:
절대적 점수나 확률은 사용하지 마세요!
❌ "91점 예상"
❌ "선정 확률 85%"
✅ "1번이 2번보다 10-15% 더 적합"
✅ "상대적으로 우수"
✅ "다른 스타일 대비 개선 효과 예상"

각 스타일을 분석하고 상대적 비교로 추천하세요.

JSON 출력:
{{
  "스타일별분석": [
    {{
      "스타일": "데이터 중심형",
      "순위": 1,
      "적합도": "매우 높음",
      "강점": [
        "정량 평가 기준(60%)에 최적화",
        "표 6개로 핵심 데이터 시각화",
        "심사위원 구성(기술전문가 60%)에 부합",
        "회사의 수치적 강점(성장률 45%, 정밀도 5배) 효과적 활용"
      ],
      "약점": [
        "스토리텔링 부족으로 감성적 어필 약함",
        "일부 섹션에서 데이터 과다로 가독성 저하 우려"
      ],
      "공고매칭": "정량 평가 60% 비중 → 최적 매칭",
      "회사매칭": "특허, 성장률, 정밀도 등 수치 강점 활용 가능",
      "상대적우위": "2번(스토리형) 대비 10-15% 우수 예상, 3번(균형형) 대비 5-8% 우수 예상",
      "추천이유": [
        "심사위원 성향(데이터 중심)에 부합",
        "경쟁 상황(경쟁률 10:1)에서 객관적 근거로 차별화 유리",
        "평가 기준의 정량적 요소에 집중"
      ],
      "개선제안": [
        "3페이지 도입부에 간단한 스토리 추가 (회사 비전)",
        "표 간격 조정으로 가독성 향상"
      ]
    }},
    {{
      "스타일": "스토리텔링형",
      "순위": 2,
      "적합도": "보통",
      "강점": [
        "회사의 성장 스토리 효과적 전달",
        "심사위원의 감성적 공감 유도",
        "차별화된 비전과 철학 제시"
      ],
      "약점": [
        "정량 평가 기준(60%)에 대한 대응 부족",
        "객관적 근거 부족으로 검증 어려움",
        "표 2개로 데이터 시각화 미흡"
      ],
      "공고매칭": "정량 평가 비중 높은 공고에 부적합",
      "회사매칭": "회사 비전은 잘 전달하나 강점 활용 미흡",
      "상대적우위": "1번(데이터형) 대비 10-15% 낮음, 3번(균형형) 대비 5% 낮음",
      "비추천이유": [
        "공고의 정량 평가 비중(60%)과 불일치",
        "심사위원 구성(기술전문가 60%)에 부적합",
        "객관적 검증 자료 부족"
      ],
      "개선제안": [
        "표 3-4개 추가 (기술 비교, 재무 계획)",
        "각 스토리에 수치적 근거 보강"
      ]
    }},
    {{
      "스타일": "균형형",
      "순위": 3,
      "적합도": "높음",
      "강점": [
        "데이터와 스토리의 적절한 조화",
        "표 4개로 핵심 내용 시각화",
        "객관성과 비전의 균형",
        "가장 무난하고 안정적"
      ],
      "약점": [
        "특별한 차별성 부족",
        "데이터 중심형 대비 정량 평가 대응 약함",
        "스토리형 대비 감성적 어필 약함"
      ],
      "공고매칭": "정량/정성 평가 균형 시 적합하나, 본 공고는 정량 60%로 약간 불리",
      "회사매칭": "회사 강점 적절히 활용하나 임팩트 부족",
      "상대적우위": "1번(데이터형) 대비 5-8% 낮음, 2번(스토리형) 대비 5% 높음",
      "추천상황": "공고 성향을 정확히 파악하기 어려운 경우 안전한 선택",
      "개선제안": [
        "표 1-2개 추가로 데이터 강화",
        "핵심 차별화 포인트를 도입부에 더 강하게 부각"
      ]
    }}
  ],

  "최종추천": {{
    "스타일": "데이터 중심형 (1번)",
    "핵심이유": [
      "공고의 정량 평가 비중(60%)에 최적화",
      "회사의 수치적 강점(특허, 성장률, 정밀도) 효과적 활용",
      "심사위원 구성(기술전문가 60%)에 부합",
      "경쟁 상황(경쟁률 10:1)에서 객관적 근거로 차별화"
    ],
    "예상효과": "다른 스타일 대비 10-15% 개선 예상 (상대적 비교)",
    "주의사항": [
      "이것은 AI의 추정이며 보장이 아닙니다",
      "최종 결정은 귀사의 판단에 따라 주시기 바랍니다",
      "선정 여부는 다양한 변수에 영향을 받습니다"
    ],
    "추가제안": "1번(데이터형)을 기본으로, 3페이지 도입부에 간단한 스토리 추가하면 더욱 효과적"
  }},

  "의사결정가이드": {{
    "데이터형_선택시": [
      "공고가 정량 평가 중심일 때",
      "회사의 수치적 강점이 명확할 때",
      "심사위원이 기술/경영 전문가 중심일 때",
      "경쟁이 치열할 때 (객관적 근거로 차별화)"
    ],
    "스토리형_선택시": [
      "공고가 정성 평가 중심일 때",
      "회사의 비전과 철학이 강점일 때",
      "사회적 가치나 공익성을 강조하는 공고일 때",
      "심사위원의 감성적 공감이 중요할 때"
    ],
    "균형형_선택시": [
      "공고 성향을 정확히 파악하기 어려울 때",
      "정량/정성 평가가 균형을 이룰 때",
      "안전하고 무난한 접근을 원할 때",
      "회사의 강점이 다양하고 균형적일 때"
    ]
  }}
}}

**중요**:
1. 절대적 점수나 확률 사용 금지
2. 상대적 비교와 경향성으로만 표현
3. 모든 추천에 명확한 근거 제시
4. 주의사항 반드시 포함
5. 의사결정 가이드로 사용자의 판단 지원
"""


# ================================================
# 프롬프트 템플릿 사용 예시
# ================================================

if __name__ == "__main__":
    # 테스트 코드
    print("✅ 프롬프트 템플릿 4개 정의 완료")
    print("\n1. ANALYZE_ANNOUNCEMENT_PROMPT (Claude Sonnet 4.5)")
    print("2. ANALYZE_COMPANY_PROMPT (Claude Sonnet 4.5)")
    print("3. GENERATE_APPLICATION_PROMPT (GPT-4o)")
    print("4. RECOMMEND_STYLE_PROMPT (Claude Sonnet 4.5)")
    print("\n스타일 가이드 5개:")
    for style_name in STYLE_GUIDES.keys():
        print(f"  - {style_name}")
